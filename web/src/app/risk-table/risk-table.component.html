<div class="d-grid bg-dark">
  <h1 class="mx-5 text text-light text-center">RIESGOS PROYECTO</h1>
  <button
    type="button"
    class="btn btn-dark border border-success border-4"
    data-bs-toggle="modal"
    data-bs-target="#FormRiskPoPUp"
  >
    <fa-icon [icon]="faHeartCirclePlus"></fa-icon>
  </button>

  <app-risk-form [projectId]="this.projectId"></app-risk-form>

  <table class="table table-dark table-striped table-hover text-center">
    <thead>
      <tr>
        <!-- <th>Id riesgo</th> -->
        <th scope="col" sortableRisk="name" (sort)="onRiskSort($event)">
          Nombre del riesgo
        </th>
        <th scope="col" sortableRisk="detectedDate" (sort)="onRiskSort($event)">
          Fecha de detección
        </th>
        <th scope="col" sortableRisk="endedDate" (sort)="onRiskSort($event)">
          Fecha de cierre
        </th>
        <th scope="col" sortableRisk="riskState" (sort)="onRiskSort($event)">
          Estado del riesgo
        </th>
        <th scope="col" sortableRisk="audience" (sort)="onRiskSort($event)">
          Audiencia
        </th>
        <th scope="col" sortableRisk="category" (sort)="onRiskSort($event)">
          Categoría
        </th>
        <th scope="col" sortableRisk="riskType" (sort)="onRiskSort($event)">
          Tipo de riesgo
        </th>
        <th scope="col">Valor de criticidad</th>
        <th colspan="2">Acciones</th>
      </tr>
    </thead>
    <tbody>
      <tr
        *ngFor="
          let risk of risks | paginate: { itemsPerPage: 30, currentPage: page }
        "
      >
        <!-- <td>{{ risk.id }}</td> -->
        <td *ngIf="risk.state === 1">{{ risk.name }}</td>
        <td *ngIf="risk.state === 1">{{ risk.detectedDate }}</td>
        <td *ngIf="risk.state === 1">{{ risk.endedDate }}</td>
        <td *ngIf="risk.state === 1">{{ risk.riskState }}</td>
        <td *ngIf="risk.state === 1">{{ risk.audience }}</td>
        <td *ngIf="risk.state === 1">{{ risk.category }}</td>
        <td *ngIf="risk.state === 1">{{ risk.riskType }}</td>
        <td *ngIf="risk.state === 1">calcular</td>
        <td *ngIf="risk.state === 1">
          <button
            class="btn btn-primary"
            [routerLink]="['/riskDetail', risk.projectId, risk.id]"
          >
            <fa-icon [icon]="faArrowUpRightFromSquare"></fa-icon>
          </button>
        </td>
        <td *ngIf="risk.state === 1">
          <button class="btn btn-danger" (click)="deleteRisk(risk)">
            <fa-icon [icon]="faTrashCan"></fa-icon>
          </button>
        </td>
      </tr>
    </tbody>
  </table>
  <pagination-controls
    (pageChange)="page = $event"
    nextLabel="Siguiente"
    previousLabel="Anterior"
  ></pagination-controls>
</div>
